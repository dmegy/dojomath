<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="manifest" href="manifest.webmanifest" />

    <link rel="stylesheet" href="css/style.css" />
    <link href="assets/fontawesome/css/fontawesome.min.css" rel="stylesheet" />
    <link href="assets/fontawesome/css/solid.min.css" rel="stylesheet" />

    <script defer src="js/functions.js"></script>
    <script defer src="js/components.js"></script>
    <script defer src="js/svg-paths.js"></script>
    <script defer src="js/app.js"></script>
    <script defer src="data_questions.js"></script>
    <script defer src="data_chapters.js"></script>
    <script defer src="data_themes.js"></script>
    <script defer src="js/quiz.js"></script>

    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 110 100'><text y='0.9em' font-size='90'>üèÜ</text></svg>"
    />
    <title>DojoMath</title>
  </head>
  <body>
    <div class="body-container">
      <header class="glow">
        <nav x-show="(state!='Quiz') && (state!='End')">
          <div class="nav-button" onClick="goto('Home')">
            <i
              id="navButtonHome"
              class="fa-solid fa-home nav-button-icon circled"
            ></i>
          </div>
          <div class="nav-button" onClick="goto('Profile')">
            <i id="navButtonProfile" class="fa-solid fa-user nav-button-icon">
            </i>
          </div>
          <div class="nav-button" onClick="goto('Statistics')">
            <i
              id="navButtonStatistics"
              class="fa-solid fa-dumbbell nav-button-icon"
            >
            </i>
          </div>
          <div class="nav-button" onClick="goto('Trophies')">
            <i
              id="navButtonTrophies"
              class="fa-solid fa-trophy nav-button-icon"
            >
            </i>
          </div>
        </nav>
        <div
          x-html="htmlPoints()"
          x-show="(state!='Quiz') && (state!='End')"
        ></div>
        <div id="quizHeader" style="width: 100%" x-show="(state=='Quiz')">
          <div style="display: flex; justify-content: space-between">
            <!-- flex-container-->
            <div onClick="showAbortQuizModal()">‚úñ</div>
            <div>+??pts</div>
          </div>
        </div>
      </header>
      <main>
        <!-- - - - - - -H O M E - - - - --->
        <section id="home" x-show="(state=='Home')">
          <h1 class="glow">Bienvenue</h1>
          <h3>R√®gles du jeu</h3>
          <p>
            Chaque r√©ponse correcte rapporte un point, chaque r√©ponse incorrecte
            enl√®ve un point.
          </p>
          <p>
            Des bonus sont octroy√©s pour des s√©ries de bonnes r√©ponses
            cons√©cutives.
          </p>
          <h3>
            Tableau des scores
            <span onclick="getHighscores()"
              ><i
                id="refreshHighscoresButton"
                class="fa-solid fa-arrow-rotate-right"
              ></i
            ></span>
          </h3>
          <p>Tous les temps / Plus r√©cents / Meilleurs Streaks</p>
          <div id="highscores">- - - Chargement des scores - - -</div>
        </section>

        <!-- - - - - - C H A P I T R E S - - - - - -->

        <section
          id="chapters"
          x-show="(state=='Chapters')"
          style="display: none"
        >
          <div x-html="htmlChapters()"></div>
        </section>

        <!-- - - - - - D E T A I L S   T H E M E - - - - - -->
        <section id="theme" x-show="(state=='theme')" style="display: none">
          <h3 x-html="theme.title"></h3>
          <p x-html="theme.info"></p>
          <div class="stats-theme">
            <div
              style="flex-grow: 1; min-height: 5rem"
              class="stats-theme-infos"
            >
              <span x-html="theme.questions.length">?</span> questions dont :
              <div style="width: 100%; height: 0.4rem"></div>
              <span style="display: inline; color: var(--c-seen)">
                <svg
                  class="svg-icon"
                  viewBox="0 0 580 512"
                  style="margin-right: 0.7rem"
                  x-html="svgPathFarEye"
                ></svg>
                <span x-html="theme.nbQuestionsSeen || '0' ">?</span>
                d√©j√† affich√©es (<span
                  x-html="theme.nbQuestionsSeen/theme.length || '0' "
                  >?</span
                >%)
              </span>
              <br />
              <span style="display: inline; color: var(--c-successful)">
                <svg
                  class="svg-icon"
                  viewBox="0 0 512 512"
                  style="margin-right: 0.7rem"
                  x-html="svgPathFasCheck"
                ></svg>
                <span x-html="theme.nbQuestionsChecked || '0' ">?</span>
                r√©ussies (<span
                  x-html="theme.nbQuestionsSuccessful/theme.length || '0' "
                  >?</span
                >%)</span
              >

              <br />
              <span style="display: inline; color: var(--c-double-successful)">
                <svg
                  class="svg-icon"
                  viewBox="0 0 512 512"
                  style="margin-right: 0.7rem"
                  x-html="svgPathFasCheckDouble"
                ></svg>
                <span x-html="theme.nbQuestionsDbChecked || '0' ">?</span>
                consolid√©es (<span
                  x-html="theme.nbQuestionsDbSuccessful/theme.length || '0' "
                  >?</span
                >%)
              </span>
            </div>
          </div>

          <div
            style="margin-top: 1.5rem"
            class="button button-primary"
            onclick="gotoChapters()"
          >
            ‚ùÆ‚ùÆ Retour √† la liste des chapitres
          </div>
          <div
            style="margin-top: 1.5rem"
            class="button button-secondary"
            onclick="startQuiz()"
          >
            Quiz de 10 questions ‚ùØ‚ùØ
          </div>
          <div x-html="htmlThemeReferences()" style="opacity: 70%"></div>
        </section>

        <!-- - - - - - S T A T S  - - - - - -->
        <section
          id="statistics"
          x-show="state=='Statistics'"
          style="display: none"
        >
          <h1 class="glow">Statistiques</h1>
          <!-- - - - S T A T S > > > BILAN- - - -->
          <h3>Bilan</h3>
          <p>
            ? questions vues dont<br />
            <span style="color: var(--c-danger)">? rat√©es, </span>
            <span style="color: var(--c-warning)">? saut√©es, </span>
            <span style="color: var(--c-success)">? r√©ussies. </span>
          </p>
          <div
            x-html="htmlTripleProgress([2,3,7])"
            style="height: 0.5rem; margin: 1rem 0"
          ></div>

          <!-- - - - S T A T S > > > A C T I V I T E   RECENTE- - - -->
          <h3><i class="fa-solid fa-chart-column"></i> Activit√© R√©cente</h3>

          <p>
            üî• Streak : <span x-html="getUserStreak()"></span> (+streak faible?)
          </p>
          <p>Pas d'activit√© √† afficher. Au travail !</p>

          <!-- - - - S T A T S > > > OBJECTIFS DU JOUR - - - -->
          <h3><i class="fa-solid fa-list-check"></i> Objectifs du jour</h3>
          <div class="margin-l-r">
            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div style="flex-shrink: 0">Gagner 100 points :</div>
              <div
                style="height: 0.5rem; flex-grow: 1"
                x-html="htmlProgress(user.points,100)"
              ></div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div style="flex-shrink: 0">Valider 5 quiz :</div>
              <div
                style="height: 0.5rem; flex-grow: 1"
                x-html="htmlProgress(2,5)"
              ></div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div>Valider un quiz avec 20/20</div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div>Valider un quiz entre 6h et 8h</div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div>Valider un quiz entre midi et 14h</div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div
                style="width: 1rem; flex-shrink: 0; text-align: center"
                x-html="htmlCheckbox(true)"
              ></div>
              <div>Valider un quiz entre 18h et 20h</div>
            </div>
          </div>
          <!-- - - - S T A T S > > > P R O C H A I N E S   E T A P E S - - - -->
          <h3>
            <i style="rotate: 20deg" class="fa-solid fa-dumbbell"></i>
            Prochaines √©tapes
          </h3>
          <div class="margin-l-r">
            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div style="flex-shrink: 0">
                Niveau <span x-html="(level(user.points)+1)"></span> (<span
                  x-html="nextLevelThreshold(user.points)"
                ></span>
                pts):
              </div>
              <div
                style="height: 0.5rem; flex-grow: 1"
                x-html="htmlProgress(user.points,nextLevelThreshold(user.points))"
              ></div>
            </div>
            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div style="flex-shrink: 0">
                R√©ussir
                <span x-html="100*Math.ceil(user.nbCorrectAnswers/100)"></span>
                questions :
              </div>
              <div
                style="height: 0.5rem; flex-grow: 1"
                x-html="htmlProgress(user.nbCorrectAnswers,100*Math.ceil(user.nbCorrectAnswers/100))"
              ></div>
            </div>
            <div style="display: flex; gap: 0.5rem; align-items: center">
              <div style="flex-shrink: 0">
                Finir
                <span x-html="10*(Math.floor(user.perfects/10)+1)"></span> quiz
                avec un score parfait :
              </div>
              <div
                style="height: 0.5rem; flex-grow: 1"
                x-html="htmlProgress(user.perfects,10*(Math.floor(user.perfects/10)+1))"
              ></div>
            </div>
          </div>
        </section>
        <!-- - - - - - / S T A T S - - - - - -->

        <!-- - - - - - P R O F I L - - - - - -->

        <section id="profile" x-show="(state=='Profile')" style="display: none">
          <h1 class="glow">Profil Utilisateur</h1>
          <p>Ici les r√©glages de club, avatar, login √©ventuel</p>

          <div class="avatar" style="width: 6rem; height: 6rem">
            <div id="avatarDisk" class="avatar-disk avatar-missing">
              <svg
                id="avantAvatar"
                style="width: 90%; height: 90%; opacity: 0.1"
                viewBox="0 0 512 512"
                class="svg-icon"
                x-html="svgPathFasUserLarge"
              ></svg>
              <img
                id="avatarImg"
                width="100%"
                height="100%"
                style="display: none"
              />
            </div>
            <label for="inputTag" class="change-avatar" style="">
              <svg
                class="svg-icon"
                viewBox="0 0 512 512"
                x-html="svgPathFasPenToSquare"
              ></svg>
              <input
                id="inputTag"
                type="file"
                accept="image/jpeg, image/png"
                style="display: none"
              />
            </label>
          </div>

          <div>
            <p>Identifiant utilisateur : <span x-html="user.userId"></span></p>
            <p>Nom utilisateur : <span x-html="user.userId"></span></p>
            <p>D√©partement (si France) :</p>
            <p>Club :</p>
          </div>

          <div>
            <h3>Sauvegarde du compte</h3>
            <p>Utilisateur c√¥t√© serveur :</p>
            <p>Tu n'est pas loggu√©(e)</p>
            <p>Boutons se loguer (pour loader un utilisateur d√©j√† existant)</p>
            <p>
              (Appara√Æt lorsqu'on d√©passe 100 pts) F√©licitations tu as plus de
              100 pts, tu as le droit de cr√©er un compte sur le serveur. Tes
              points sont de toute fa√ßon sauvegard√©s sur ton nagifateur, mais un
              compte sur le serveur permettra de r√©cup√©rer tes points si tu
              effaces l'historique de ton navigateur, ou si tu joues depuis une
              autre machine.
            </p>
          </div>
        </section>

        <!-- - - - - - T R O P H E E S  - - - - - -->
        <section
          id="trophies"
          x-show="(state=='Trophies')"
          style="display: none"
        >
          <h1 class="glow">Troph√©es</h1>
          <p>Tes troph√©es seront affich√©s ici.</p>
        </section>

        <!-- - - - - -  / ! \  - - Q U I Z - - / ! \ - - - - - -->

        <section id="quiz" x-show="(state=='Quiz')" style="display: none">
          <div
            style="
              height: 100%;
              display: flex;
              flex-direction: column;
              justify-content: end;
            "
          >
            <div
              class="quiz-statement"
              style="flex-grow: 1; border: 1px dashed green"
              x-html="question.statement"
            ></div>
            <div class="quiz-answer">
              <div
                class="button-answer button-answer-false"
                onclick="submitAnswer(false)"
              >
                FAUX
              </div>
              <div
                class="button-answer button-answer-undefined"
                onclick="submitAnswer(undefined)"
              >
                PASSER
              </div>
              <div
                class="button-answer button-answer-true"
                onclick="submitAnswer(true)"
              >
                VRAI
              </div>
            </div>
          </div>
        </section>

        <!-- - - - - - E N D  / Q U I Z  T E R M I N √â  - - - - - -->
        <section id="trophies" x-show="(state=='End')" style="display: none">
          <h1 style="text-align: center">
            <span x-html="quiz.finalGrade"></span>/20
            <!-- ic√¥ne suivant le r√©sultat-->
            <span x-html="glyphResult(quiz.finalGrade)"> </span>
          </h1>

          <p style="color: var(--c-texte-inactif)">
            ‚ìò La note est calcul√©e sans tenir compte des p√©nalit√©s dues aux
            erreurs ni des bonus de bonnes r√©ponses successives. Les points
            gagn√©s, eux, tiennent compte des bonus et malus.
          </p>

          <div style="margin: 1rem; width: 100%-2rem">
            <table width="100%" style="border-collapse: collapse">
              <thead>
                <tr>
                  <th
                    style="
                      text-align: left;
                      font-size: 1.2rem;
                      font-weight: 800;
                      border-bottom: 1px white solid;
                    "
                  >
                    D√©tails
                  </th>
                  <th
                    style="
                      text-align: right;
                      font-size: 1.2rem;
                      font-weight: 800;
                      border-bottom: 1px white solid;
                    "
                  >
                    Points
                  </th>
                </tr>
              </thead>
              <tbody id="tableauResultats">
                <tr>
                  <td>
                    <span x-html="quiz.success">0</span>
                    questions r√©ussies :
                  </td>
                  <td style="text-align: right">
                    +
                    <span x-html="htmlPoints(quiz.success)">0</span>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span x-html="quiz.fail">0</span>
                    questions rat√©es :
                  </td>
                  <td style="text-align: right">
                    -
                    <span x-html="htmlPoints(quiz.fail)">0</span>
                  </td>
                </tr>
                <tr>
                  <td>
                    <span x-html="quiz.skipped">0</span>
                    questions saut√©es :
                  </td>
                  <td style="text-align: right">0 pts</td>
                </tr>
                <tr x-show="quiz.bonus>0">
                  <td>Bonus r√©ussites cons√©cutives :</td>
                  <td style="text-align: right">
                    +
                    <span x-html="htmlPoints(quiz.bonus)"></span>
                  </td>
                </tr>
                <tr x-show="getBooster(new Date())>1">
                  <td>BOOSTER ACTIF:</td>
                  <td style="text-align: right">
                    x<span x-html="getBooster(new Date())"></span>
                  </td>
                </tr>
              </tbody>
              <tfoot>
                <tr
                  style="
                    text-align: left;
                    font-size: 1.2rem;
                    font-weight: 800;
                    border-top: 1px white solid;
                  "
                >
                  <td style="text-align: left">TOTAL :</td>
                  <td style="text-align: right">
                    + <span x-html="htmlPoints(quiz.points)"></span>
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>

          <div class="button button-primary" onclick="unstack('Chapters')">
            <i class="fa-solid fa-list-Ul"></i>
            Retour √† la liste des th√®mes
          </div>
          <div class="button button-primary" onclick="unstack('Theme')">
            <i class="fa-solid fa-circle-play"></i>> Nouveau quiz
          </div>

          <h4 style="padding-top: 1rem">Correction :</h4>
          <div>Remettre les √©ventuels liens</div>

          <div id="correction" style="flex-direction: column-reverse">
            <!--- - - - - correction - - - - - -->
          </div>

          <p style="text-align: justify; text-justify: auto">
            Note : s'il y a un probl√®me avec une question, le num√©ro de la
            question peut aider √† signaler ce probl√®me. Cela dit, les √©nonc√©s
            sont normalement corrects et le diable se cache dans les d√©tails.
          </p>
        </section>

        <!-- - - - - - F A B (Floating Action Button ) - - - - - -->
        <div
          id="fab"
          class="button fab pulse"
          onClick="gotoChapters()"
          x-show="(state=='Home')||(state=='Profile')||(state=='Statistics')||(state=='Trophies')"
        >
          <i class="fa-solid fa-play" style="transform: translateX(0.1rem)"></i>
        </div>
        <!-- - - - - - F O O T E R  - - - - - -->
        <footer x-show="!((state=='Quiz')||(state=='End'))">
          <div>
            DojoMath est une cr√©ation du <br />Club Math√©matique de Nancy
            (lien)<br />
          </div>

          <div>
            DojoMath pour les profs<br />
            FAQ
          </div>
        </footer>
      </main>
    </div>
  </body>
</html>
